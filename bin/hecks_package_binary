#!/usr/bin/env ruby

exec [
  'cd packages/binary/build/resources',
  'curl -O http://d6r77u77i8pq3.cloudfront.net/releases/traveling-ruby-20150715-2.2.2-osx.tar.gz',
  'curl -O http://d6r77u77i8pq3.cloudfront.net/releases/traveling-ruby-20150715-2.2.2-linux-x86_64.tar.gz',
  'cd ..',
  'tar -xzf resources/traveling-ruby-20150715-2.2.2-linux-x86_64.tar.gz -C linux-x86_64/lib/ruby',
  'tar -xzf resources/traveling-ruby-20150715-2.2.2-osx.tar.gz -C osx/lib/ruby',
  'mv ruby-version .ruby-version',
  'bundle',
  'BUNDLE_IGNORE_CONFIG=1 bundle install --path vendor --without development --no-cache',
  # 'rm -f vendor/*/*/cache/*',
  'cp -rf vendor osx',
  'cp -rf vendor linux-x86_64'
].join("&&")

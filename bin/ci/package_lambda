#!/bin/bash
HECKS_DIR=`pwd`
PIZZA_BUILDER_DIR='hecks-examples/pizza_builder'
BINARY_ATTRIBUTES='{"name":"White Pizza","description":"white sauce and chicken","chef":{"name":"Chef Ramsey"},"toppings":[{"name":"chicken"}]}'
LOCAL_CREATE_PIZZZA_COMMAND='serverless invoke local -f pizza_builder -l -d'
REMOTE_CREATE_PIZZZA_COMMAND='serverless invoke -f pizza_builder -l -s production -d'

cd $PIZZA_BUILDER_DIR

hecks package lambda
cd packages/lambda/
$LOCAL_CREATE_PIZZZA_COMMAND "{\"module\": \"pizzas\", \"method\": \"create\", \"data\": $BINARY_ATTRIBUTES}"
serverless deploy -f pizza_builder -s production
$REMOTE_CREATE_PIZZZA_COMMAND "{\"module\": \"pizzas\", \"method\": \"create\", \"data\": $BINARY_ATTRIBUTES}"

cd $HECKS_DIR
